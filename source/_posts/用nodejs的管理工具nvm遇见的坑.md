---
title: 用nodejs管理工具nvm遇见的坑
date: 2017-1-18 22:20:11
tags: [nvm,js,nodejs]
---
用nvm管理的几个nodejs版本,其中只有第一个下载的node版本的npm能使用,剩下的都不能使用!    
我很纳闷,因为这样的话,除了能使用的那个node,剩下的根本都不能npm,那这个nodejs版本还有什么用.我越想越觉得不对,肯定是什么地方出错了,才会导致这样的结果..

踩坑之旅开始了

事情是这样的,因为项目不同,有时候要用的node版本也不同.然后我百度知道了一个nodejs的管理工具叫nvm,[贴上一个大神的博客.](http://dajyaretakuya.blog.51cto.com/2823475/1760255/)    
我用的是windows版本的nvm.版本号是1.1.1

然后一个巨大的坑出现了,我第一次用这个nvm. 刚刚开始安装的很顺利,就是下载nvm有点难下载,速度很慢. 然后安装基本无压力,nvm会自动的帮你把环境变量配置好,当然,也可以自己配置,因为有时候想要它的文件地址掌控在自己的手中.    
环境变量配置:

	NVM_HOME = C:\nvm  //新建这两个变量
	NVM_SYMLINK = C:\nodejs 
	Path = %NVM_HOME%;%NVM_SYMLINK%  //这个是直接配置在系统的path里面的.

弄好nvm后,通过命令下载nodejs

	nvm install 版本号

然后我下载的第一个node一切正常,npm什么的正常使用.    
但是当我的下载的第二个第三个node的时候,发现npm根本不能使用.

发现这个问题后,我百度,google了很久,看了许多博文,发现他们的方法不太适合我这个问题.我也配置了无数遍的环境变量,结果还是不行.基本上方法都用了一遍,这个问题就是不能解决.

到了后面,我看到一篇博文的[关于npm安装和环境变量的配置](http://blog.csdn.net/stopcpp/article/details/53909558)给了我点启发,他把npm的包,放到了他新建的nvm文件夹里.    
我就在想,npm包的事,结果我发现,除了第一个安装的node里面的node_modules是有npm这个文件,剩下的都是空的,我想,这个应该就是问题的所在了吧.    
然后我试了试,把第一个成功的node版本的node_modules文件夹里的npm文直接复制到另一个版本的node_modules文件夹里面.结果奇迹出现了,切换到这个版本的node后,输入命令 npm -v 发现有输出版本号了. 

到此,问题解决了.

但是还有更坑的是什么,我还是不甘心,又试了一下nvm,我把一些不能用npm的node直接从文件夹中删除.然后又重新通过命令 nvm install 版本号 下载这个node版本, 发现这个node的npm有了! 

对,你没听错, 有了!

我只想说,兄弟,不带这么玩的吧..


对了,还有个情况就是,npm下载东西,因为服务器在国外,速度很慢,甚至下载不成功.所以要通过国内的镜像服务器来下载, 比如 淘宝的 和 cnpm

这里,还有一个叫nrm的东西,很好用,就是专门处理这个情况的.

nrm的用法是:

	npm install -g nrm //全局下载安装这个nrm 
列出所有可以用的npm的镜像源地址

	nrm ls //安装后可以使用这个命令
然后,想用哪个镜像源,就用哪个,国内肯定是cnpm和淘宝(淘宝10分钟同步国外的npm库一次,cnpm15分钟同步一次)的啦.

	nrm use cnpm //使用cnpm这个镜像源下网络载nodejs的库.提升网速度

测试每个镜像源的链接速度
	
	nrm test //测试速度,一般淘宝的最快

好啦,这个工具我感觉挺好用的,特别是下载库的时候速度太慢,可以切换镜像源,用这个nrm最方便.连地址你都可以不用百度了,直接用nrm帮你换地址就成了.

记得,一定要加 -g 全局安装 nrm 让其他版本的nodejs都能用,所以记得,我觉得不仅仅是nrm要全局安装,其实如果用这个nvm管理多个node的话,其他的node也要用库,全局安装就不用这么麻烦,每个都要下载一遍,直接全局安装就行.

